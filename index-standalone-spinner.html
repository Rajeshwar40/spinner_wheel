<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Spinner Wheel</title>
<style>
  :root { color-scheme: dark; }
  body { margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, 'Helvetica Neue', Arial; background:#0a0a0a; color:#e5e5e5; }
  .wrap { max-width: 1200px; margin: 0 auto; padding: 24px; display: grid; gap: 24px; grid-template-columns: 1.2fr 1fr; }
  @media (max-width: 900px){ .wrap{ grid-template-columns: 1fr; } }
  .card { background: #121212; border-radius: 16px; padding: 20px; box-shadow: 0 10px 30px rgba(0,0,0,.4); }
  .btn { background:#10b981; border:0; color:#fff; padding:10px 16px; border-radius:999px; cursor:pointer; font-weight:600; }
  .btn:disabled { opacity:.6; cursor:not-allowed; }
  .btn-secondary { background:#2a2a2a; }
  .controls { display:flex; gap:12px; flex-wrap:wrap; align-items:center; margin-top:12px;}
  .pointer { position:absolute; left:50%; transform: translateX(-50%); top:4%; width:0; height:0;
             border-left:18px solid transparent; border-right:18px solid transparent; border-top:40px solid #fff; filter: drop-shadow(0 2px 2px rgba(0,0,0,.5)); z-index:5;}
  .wheel { position:relative; width:min(520px, 100%); aspect-ratio:1/1; margin:0 auto; border-radius:50%; background:#1f2937; overflow:hidden;}
  .hub { position:absolute; inset:0; display:flex; align-items:center; justify-content:center; pointer-events:none;}
  .hub div{ width:64px; height:64px; background:#fff; border-radius:50%; box-shadow: inset 0 0 10px rgba(0,0,0,.4);}
  textarea{ width:100%; height:320px; background:#1c1c1c; color:#e5e5e5; border:1px solid #2f2f2f; border-radius:12px; padding:12px; resize:vertical; }
  .label{ font-size:14px; color:#a3a3a3; }
  .winner{ margin-top:12px; font-size:18px; }
  svg text{ font-weight:600; letter-spacing:.2px; }
</style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>Rigged Wheel of Names</h1>
      <div class="wheel-area" style="position:relative; display:flex; justify-content:center;">
        <div class="pointer"></div>
        <div class="wheel">
          <svg id="wheelSvg" viewBox="0 0 100 100" style="width:100%; height:100%">
            <g id="slices" transform="translate(50,50)"></g>
          </svg>
          <div class="hub"><div></div></div>
        </div>
      </div>

      <div class="controls">
        <button id="spinBtn" class="btn">Spin</button>
        <button id="resetBtn" class="btn btn-secondary">Reset</button>
        <label class="label"><input type="checkbox" id="rig" checked> Force 4th name (rig mode)</label>
        <label class="label">Duration <input id="duration" type="number" min="1000" max="15000" step="500" value="5000" style="width:90px; background:#1c1c1c; color:#e5e5e5; border:1px solid #2f2f2f; border-radius:8px; padding:4px 8px;"> ms</label>
      </div>
      <div id="winner" class="winner"></div>
    </div>

    <div class="card">
      <h2>Names (one per line)</h2>
      <textarea id="namesTa">Arjun
Vikrant
Shreya
Shivanshu
Sanjay
Rajeshwar
Rohit
Mohit
Manikanta
Kaushiki</textarea>
      <div class="controls">
        <button id="shuffleBtn" class="btn" style="background:#3b82f6;">Shuffle Names</button>
        <button id="tipBtn" class="btn btn-secondary">Tip: 4th position wins</button>
      </div>
      <p class="label">With <span style="color:#10b981">Rig mode</span> enabled, the wheel will always land with the 4th name directly under the pointer. Turn it off to spin fairly.</p>
    </div>
  </div>

<script>
  const palette = ["#1e3a8a","#ef4444","#f59e0b","#16a34a"];
  const startAngle = -90;
  let spinning = false;
  let currentAngle = 0;

  function degToRad(d){ return d*Math.PI/180; }

  function getNames(){
    return document.getElementById('namesTa').value
      .split(/\r?\n/)
      .map(s=>s.trim())
      .filter(Boolean);
  }

  function drawWheel(){
    const names = getNames();
    const g = document.getElementById('slices');
    g.innerHTML = '';
    if(names.length === 0) return;
    const seg = 360/names.length;
    const r = 48;

    names.forEach((label, i)=>{
      const a0 = degToRad(i*seg + startAngle);
      const a1 = degToRad((i+1)*seg + startAngle);
      const x0 = r*Math.cos(a0), y0 = r*Math.sin(a0);
      const x1 = r*Math.cos(a1), y1 = r*Math.sin(a1);
      const large = seg > 180 ? 1 : 0;
      const path = `M0 0 L ${x0.toFixed(3)} ${y0.toFixed(3)} A ${r} ${r} 0 ${large} 1 ${x1.toFixed(3)} ${y1.toFixed(3)} Z`;
      const mid = degToRad(i*seg + startAngle + seg/2);
      const tx = (r*0.65)*Math.cos(mid);
      const ty = (r*0.65)*Math.sin(mid);

      const slice = document.createElementNS('http://www.w3.org/2000/svg','g');
      const p = document.createElementNS('http://www.w3.org/2000/svg','path');
      p.setAttribute('d', path);
      p.setAttribute('fill', palette[i%palette.length]);
      p.setAttribute('stroke', '#111');
      p.setAttribute('stroke-width', '0.5');
      slice.appendChild(p);

      const t = document.createElementNS('http://www.w3.org/2000/svg','text');
      t.setAttribute('x', tx);
      t.setAttribute('y', ty);
      t.setAttribute('fill', '#fff');
      t.setAttribute('dominant-baseline','middle');
      t.setAttribute('text-anchor','middle');
      t.setAttribute('font-size', Math.max(6, 14 - Math.max(0, names.length-6)));
      t.setAttribute('transform', `rotate(${(i*seg + startAngle + seg/2)} ${tx} ${ty})`);
      t.textContent = label;
      slice.appendChild(t);

      g.appendChild(slice);
    });
  }

  function angleForIndex(i, seg){
    const center = startAngle + i*seg + seg/2;
    const pointerAngle = -90;
    return pointerAngle - center; // rotate wheel so that slice center meets pointer
  }

  function spin(){
    if(spinning) return;
    const names = getNames();
    if(names.length===0) return;
    const seg = 360/names.length;

    const rig = document.getElementById('rig').checked;
    const forcedIndex = 3;
    const targetIndex = (rig && names.length>forcedIndex) ? forcedIndex : Math.floor(Math.random()*names.length);

    const extraSpins = 8 + Math.floor(Math.random()*4);
    const delta = angleForIndex(targetIndex, seg) + extraSpins*360;

    const svg = document.getElementById('wheelSvg');
    spinning = true;
    svg.style.transition = `transform ${Number(duration.value)}ms cubic-bezier(0.2, 0.9, 0.2, 1)`;
    svg.style.transform = `rotate(${delta}deg)`;

    setTimeout(()=>{
      spinning = false;
      document.getElementById('winner').innerHTML = 'Winner: <span style="color:#10b981; font-weight:700;">' + (names[targetIndex]||'') + '</span>';
    }, Number(duration.value)+50);
  }

  function resetWheel(){
    const svg = document.getElementById('wheelSvg');
    svg.style.transition = 'none';
    svg.style.transform = 'rotate(0deg)';
    document.getElementById('winner').textContent = '';
  }

  // UI hooks
  document.getElementById('namesTa').addEventListener('input', drawWheel);
  document.getElementById('spinBtn').addEventListener('click', spin);
  document.getElementById('resetBtn').addEventListener('click', resetWheel);
  document.getElementById('shuffleBtn').addEventListener('click', ()=>{
    const names = getNames();
    for(let i=names.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [names[i],names[j]]=[names[j],names[i]]; }
    document.getElementById('namesTa').value = names.join('\n');
    drawWheel();
  });
  document.getElementById('tipBtn').addEventListener('click', ()=>alert('Tip: The 4th name in the list wins when rig mode is on.'));
  // initial draw
  drawWheel();
</script>
</body>
</html>
